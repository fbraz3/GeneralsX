<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="icon" href="images/Vulkan_LogoBug_48px_Nov17.png">
<link rel="stylesheet" href="github-markdown.css">
</head>
<body>
<article class="markdown-body">
<h1 id="convert">Convert</h1>
<p>The <code>gfxrecon-convert</code> tool converts a capture file into a JSON document (or a series of JSON documents, one per line following the <a href="https://jsonlines.org/" TARGET="_blank">JSON Lines standard</a>.)</p>
<p>The text output is written by default to a .json file in the directory of the specified GFXReconstruct capture file. Use <code>--output</code> to override the default filename for the output.</p>
<pre class="text"><code>gfxrecon-convert - A tool to convert GFXReconstruct capture files to text.

Usage:
  gfxrecon-convert [-h | --help] [--version] &lt;file&gt;

Required arguments:
  &lt;file&gt;                Path to the GFXReconstruct capture file to be converted
                        to text.

Optional arguments:
  -h                    Print usage information and exit (same as --help).
  --version             Print version information and exit.
  --output filename     &#39;stdout&#39; or a path to a file to write JSON output
                        to. Default is the input filepath with &quot;gfxr&quot; replaced
                        by &quot;jsonl&quot;.
  --format &lt;format&gt;     JSON format to write.
           json         Standard JSON format (indented)
           jsonl        JSON lines format (every object in a single line)
  --include-binaries    Dump binaries from Vulkan traces in a separate file with an unique name. The main JSON file
                        will include a reference with the file name. The binary files are dumped in a subdirectory
  --expand-flags        Print flags values from Vulkan traces with its correspondent symbolic representation. Otherwise,
                        the flags are printed as hexadecimal value.
  --file-per-frame      Creates a new file for every frame processed. Frame number is added as a suffix
                        to the output file name.
  --no-debug-popup      Disable the &#39;Abort, Retry, Ignore&#39; message box
                        displayed when abort() is called (Windows debug only).
</code></pre>
<p>The JSON document is designed to be parsed by tools such as simple Python scripts as well as being useful for inspecting by eye after pretty printing, for example by piping through a command-line tool such as <a href="https://stedolan.github.io/jq/" TARGET="_blank"><code>jq</code></a>. For these post-processing use cases, <code>gfxrecon-convert</code> can be used to stream from binary captures directly, without having to save the intermediate JSON files to storage. With <code>"--format jsonl"</code>, because each JSON object is on its own line, line oriented tools such as grep, sed, head, and split can be applied ahead of JSON-aware ones which are heavier-weight to reduce their workload on large captures.</p>
<h2 id="json-structure">JSON Structure</h2>
<p>The tool's output is an ordered list of JSON structures, or a single JSON structure per line in <code>--format jsonl</code> mode. Below are the first few lines from a capture of vkcube, converted using the "--format jsonl" flag, truncated to 200 columns.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">{</span><span class="dt">&quot;header&quot;</span><span class="fu">:{</span><span class="dt">&quot;source-path&quot;</span><span class="fu">:</span><span class="st">&quot;..</span><span class="ch">\\</span><span class="st">captures</span><span class="ch">\\</span><span class="st">vkcube_frames_1_through_20_20240321T112609.gfxr&quot;</span><span class="fu">,</span><span class="dt">&quot;gfxrecon-version&quot;</span><span class="fu">:</span><span class="st">&quot;1.0.3-dev (dev:52a52d3+dx12)&quot;</span><span class="fu">,</span><span class="dt">&quot;vulkan-version&quot;</span><span class="fu">:</span><span class="st">&quot;1.3.280&quot;</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;annotation&quot;</span><span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;kJson&quot;</span><span class="fu">,</span><span class="dt">&quot;label&quot;</span><span class="fu">:</span><span class="st">&quot;operation&quot;</span><span class="fu">,</span><span class="dt">&quot;data&quot;</span><span class="fu">:</span><span class="st">&quot;{</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">tool</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">capture</span><span class="ch">\&quot;</span><span class="st">,</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">timestamp</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">2024-03-21T15:26:09Z</span><span class="ch">\&quot;</span><span class="st">,</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">gfxrecon-version</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">1.0.3-dev (dev:52a52d3+dx12...</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">{&quot;</span><span class="er">index</span><span class="st">&quot;:2,&quot;</span><span class="er">function</span><span class="st">&quot;:{&quot;</span><span class="er">name</span><span class="st">&quot;:&quot;</span><span class="er">vkCreateInstance</span><span class="st">&quot;,&quot;</span><span class="er">thread</span><span class="st">&quot;:1,&quot;</span><span class="er">return</span><span class="st">&quot;:&quot;</span><span class="er">VK_SUCCESS</span><span class="st">&quot;,&quot;</span><span class="er">args</span><span class="st">&quot;:{&quot;</span><span class="er">pCreateInfo</span><span class="st">&quot;:...{&quot;</span><span class="er">sType</span><span class="st">&quot;:&quot;</span><span class="er">VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO</span><span class="st">&quot;,&quot;</span><span class="er">flags</span><span class="st">&quot;:&quot;</span><span class="dv">0</span><span class="er">x00000001</span><span class="st">&quot;,&quot;</span><span class="er">pApplicationInfo</span><span class="st">&quot;:{&quot;</span><span class="er">sTyp...</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">3</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkEnumeratePhysicalDevices&quot;</span><span class="fu">,</span><span class="dt">&quot;thread&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;instance&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDeviceCount&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDevices&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkEnumeratePhysicalDevices&quot;</span><span class="fu">,</span><span class="dt">&quot;thread&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;instance&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDeviceCount&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDevices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">2</span><span class="ot">,</span><span class="dv">3</span><span class="ot">]</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">5</span><span class="fu">,</span><span class="dt">&quot;meta&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;SetDevicePropertiesCommand&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;physical_device_id&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;api_version&quot;</span><span class="fu">:</span><span class="dv">4206842</span><span class="fu">,</span><span class="dt">&quot;driver_version&quot;</span><span class="fu">:</span><span class="dv">1659359</span><span class="fu">,</span><span class="dt">&quot;vendor_id&quot;</span><span class="fu">:</span><span class="dv">32902</span><span class="fu">,</span><span class="dt">&quot;device_id&quot;</span><span class="fu">:</span><span class="dv">18086</span><span class="fu">,</span><span class="dt">&quot;device_type&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pipeline_cache...</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dt">{&quot;</span><span class="er">index</span><span class="dt">&quot;:6,&quot;</span><span class="er">meta</span><span class="dt">&quot;:{&quot;</span><span class="er">name</span><span class="dt">&quot;:&quot;</span><span class="er">SetDeviceMemoryPropertiesCommand</span><span class="dt">&quot;,&quot;</span><span class="er">args</span><span class="dt">&quot;:{&quot;</span><span class="er">physical_device_id</span><span class="dt">&quot;:2}}}...</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="dt">{&quot;</span><span class="er">index</span><span class="dt">&quot;:7,&quot;</span><span class="er">meta</span><span class="dt">&quot;:{&quot;</span><span class="er">name</span><span class="dt">&quot;:&quot;</span><span class="er">SetDevicePropertiesCommand</span><span class="dt">&quot;,&quot;</span><span class="er">args</span><span class="dt">&quot;:{&quot;</span><span class="er">physical_device_id</span><span class="dt">&quot;:3,&quot;</span><span class="er">api_version</span><span class="dt">&quot;:4206852,&quot;</span><span class="er">driver_version</span><span class="dt">&quot;:2287403008,&quot;</span><span class="er">vendor_id</span><span class="dt">&quot;:4318,&quot;</span><span class="er">device_id</span><span class="dt">&quot;:9632,&quot;</span><span class="er">device_type</span><span class="dt">&quot;:2,&quot;</span><span class="er">pipeline_cach...</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="er">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span><span class="dt">&quot;meta&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;SetDeviceMemoryPropertiesCommand&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;physical_device_id&quot;</span><span class="fu">:</span><span class="dv">3</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">9</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkEnumeratePhysicalDevices&quot;</span><span class="fu">,</span><span class="dt">&quot;thread&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;instance&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDeviceCount&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;pPhysicalDevices&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}</span></a></code></pre></div>
<p>Subsequent examples are from captures converted with "--format jsonl" and then pretty-printed with jq.</p>
<p>The file begins with a header object containing some metadata, followed by a series of objects representing the sequence of Vulkan calls stored in the capture. Below are some examples generated from the same capture of <code>vkcube</code> listed above but pretty-printed with <code>gfxrecon-convert --output stdout vkcube.f1.gfxr | jq</code>.</p>
<p>The first line is a header identifying the source capture file, and the version of GFXReconstruct and Vulkan headers used to build <code>gfxrecon-convert</code>. Note this is <em>not necessarily</em> the revision of the source used to build the capture layer that saved the source <code>.gfxr</code> capture file; see the <code>annotation</code> below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb3-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="dt">&quot;header&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="dt">&quot;source-path&quot;</span><span class="fu">:</span> <span class="st">&quot;..</span><span class="ch">\\</span><span class="st">captures</span><span class="ch">\\</span><span class="st">vkcube_frames_1_through_20_20240321T112609.gfxr&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="dt">&quot;gfxrecon-version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0.3-dev (dev:52a52d3+dx12)&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="dt">&quot;vulkan-version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.3.280&quot;</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="fu">}</span></a></code></pre></div>
<p>Following the header there may be an annotation block containing metadata about the capture. This annotation contains the version of the GFXReconstruct source and Vulkan headers used to build the capture layer that was active during application capture. In more straightforward terms, this is the version of GFXReconstruct that created the <code>.gfxr</code> file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb4-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">&quot;annotation&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;kJson&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="dt">&quot;label&quot;</span><span class="fu">:</span> <span class="st">&quot;operation&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="st">&quot;{</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">tool</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">capture</span><span class="ch">\&quot;</span><span class="st">,</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">timestamp</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">2024-03-21T15:26:09Z</span><span class="ch">\&quot;</span><span class="st">,</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">gfxrecon-version</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">1.0.3-dev (dev:52a52d3+dx12)</span><span class="ch">\&quot;</span><span class="st">,</span><span class="ch">\n</span><span class="st">    </span><span class="ch">\&quot;</span><span class="st">vulkan-version</span><span class="ch">\&quot;</span><span class="st">: </span><span class="ch">\&quot;</span><span class="st">1.3.280</span><span class="ch">\&quot;\n</span><span class="st">}&quot;</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="fu">}</span></a></code></pre></div>
<h3 id="vulkan-function">Vulkan function</h3>
<p>For Vulkan, the first Vulkan function of the capture follows. Of note are the fields <code>"function"</code> which identifies the line as Vulkan function call, and <code>"index"</code> which is a monotonically increasing positive integer representing the position of the call in the sequence recorded in the capture.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb5-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">&quot;function&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;vkCreateInstance&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="dt">&quot;thread&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="dt">&quot;return&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb5-8" title="8">      <span class="dt">&quot;pCreateInfo&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb5-9" title="9">        <span class="dt">&quot;sType&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-10" title="10">        <span class="dt">&quot;flags&quot;</span><span class="fu">:</span> <span class="st">&quot;0x00000001&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-11" title="11">        <span class="dt">&quot;pApplicationInfo&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb5-12" title="12">          <span class="dt">&quot;sType&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_STRUCTURE_TYPE_APPLICATION_INFO&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-13" title="13">          <span class="dt">&quot;pApplicationName&quot;</span><span class="fu">:</span> <span class="st">&quot;vkcube&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-14" title="14">          <span class="dt">&quot;applicationVersion&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-15" title="15">          <span class="dt">&quot;pEngineName&quot;</span><span class="fu">:</span> <span class="st">&quot;vkcube&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-16" title="16">          <span class="dt">&quot;engineVersion&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-17" title="17">          <span class="dt">&quot;apiVersion&quot;</span><span class="fu">:</span> <span class="dv">4194304</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-18" title="18">          <span class="dt">&quot;pNext&quot;</span><span class="fu">:</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb5-19" title="19">        <span class="fu">},</span></a>
<a class="sourceLine" id="cb5-20" title="20">        <span class="dt">&quot;enabledLayerCount&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-21" title="21">        <span class="dt">&quot;ppEnabledLayerNames&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-22" title="22">        <span class="dt">&quot;enabledExtensionCount&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-23" title="23">        <span class="dt">&quot;ppEnabledExtensionNames&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb5-24" title="24">          <span class="st">&quot;VK_KHR_surface&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb5-25" title="25">          <span class="st">&quot;VK_KHR_win32_surface&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb5-26" title="26">          <span class="st">&quot;VK_KHR_get_physical_device_properties2&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb5-27" title="27">          <span class="st">&quot;VK_KHR_portability_enumeration&quot;</span></a>
<a class="sourceLine" id="cb5-28" title="28">        <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-29" title="29">        <span class="dt">&quot;pNext&quot;</span><span class="fu">:</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb5-30" title="30">      <span class="fu">},</span></a>
<a class="sourceLine" id="cb5-31" title="31">      <span class="dt">&quot;pAllocator&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-32" title="32">      <span class="dt">&quot;pInstance&quot;</span><span class="fu">:</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-33" title="33">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb5-34" title="34">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="fu">}</span></a></code></pre></div>
<h3 id="d3d12-method">D3D12 method</h3>
<p>For D3D12, the first D3D12 method of the capture follows. Of note are the fields <code>"method"</code> which identifies the line as D3D12 method call, and <code>"index"</code> which is a monotonically increasing positive integer representing the position of the call in the sequence recorded in the capture.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb6-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">79</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;CreateHeap&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="dt">&quot;thread&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">    <span class="dt">&quot;object&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;ID3D12Device&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">      <span class="dt">&quot;handle&quot;</span><span class="fu">:</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb6-9" title="9">    <span class="fu">},</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="dt">&quot;return&quot;</span><span class="fu">:</span> <span class="st">&quot;S_OK&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-11" title="11">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-12" title="12">      <span class="dt">&quot;pDesc&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-13" title="13">        <span class="dt">&quot;SizeInBytes&quot;</span><span class="fu">:</span> <span class="dv">2097152</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-14" title="14">        <span class="dt">&quot;Properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-15" title="15">          <span class="dt">&quot;Type&quot;</span><span class="fu">:</span> <span class="st">&quot;D3D12_HEAP_TYPE_CUSTOM&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-16" title="16">          <span class="dt">&quot;CPUPageProperty&quot;</span><span class="fu">:</span> <span class="st">&quot;D3D12_CPU_PAGE_PROPERTY_NOT_AVAILABLE&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-17" title="17">          <span class="dt">&quot;MemoryPoolPreference&quot;</span><span class="fu">:</span> <span class="st">&quot;D3D12_MEMORY_POOL_L1&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-18" title="18">          <span class="dt">&quot;CreationNodeMask&quot;</span><span class="fu">:</span> <span class="st">&quot;0b00000000000000000000000000000000&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-19" title="19">          <span class="dt">&quot;VisibleNodeMask&quot;</span><span class="fu">:</span> <span class="st">&quot;0b00000000000000000000000000000000&quot;</span></a>
<a class="sourceLine" id="cb6-20" title="20">        <span class="fu">},</span></a>
<a class="sourceLine" id="cb6-21" title="21">        <span class="dt">&quot;Alignment&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-22" title="22">        <span class="dt">&quot;Flags&quot;</span><span class="fu">:</span> <span class="st">&quot;0x00000044&quot;</span></a>
<a class="sourceLine" id="cb6-23" title="23">      <span class="fu">},</span></a>
<a class="sourceLine" id="cb6-24" title="24">      <span class="dt">&quot;riid&quot;</span><span class="fu">:</span> <span class="st">&quot;IID_ID3D12Heap&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-25" title="25">      <span class="dt">&quot;ppvHeap&quot;</span><span class="fu">:</span> <span class="dv">170</span></a>
<a class="sourceLine" id="cb6-26" title="26">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb6-27" title="27">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="fu">}</span></a></code></pre></div>
<h3 id="type-mapping-of-values">Type Mapping of Values</h3>
<p>Values in the file such as function arguments, function return values, and structure members are mapped to the following JSON representations.</p>
<h4 id="scalar-numeric-types">Scalar Numeric Types</h4>
<p><code>int</code>, <code>float</code>, <code>double</code>, and related types and aliases are represented with the JSON number type. The output is additionally constrained to match the underlying C type, so a value like <code>1.1</code> will never be output where the C type is an integer, despite that being a valid JSON number.</p>
<h4 id="handles">Handles</h4>
<p>Handles in capture files are represented by integers. I.e., the <em>ith</em> handle allocation will be stored as the integer <em>i</em>, counting from one. Convert shows those integers as the JSON number type, constrained to be positive integers.</p>
<h4 id="strings">Strings</h4>
<p><code>const char*</code> strings from the C-API are represented as JSON strings.</p>
<h4 id="enumerations">Enumerations</h4>
<p>Single enumerator values (as opposed to the result of ORing together several flags defined by an enumeration) such as <code>VkResult</code>'s <code>VK_SUCCESS</code> and <code>VK_INCOMPLETE</code> are represented by JSON strings holding the exact character sequence used in the C-API enumerator, so <code>"VK_SUCCESS"</code> and <code>"VK_INCOMPLETE"</code> in the preceding examples.</p>
<h4 id="masks--flag-sets">Masks / Flag Sets</h4>
<p>Theses are currently output as JSON numbers with their bit patterns interpreted as an unsigned decimal integer. Tools written now should test whether masks are represented as JSON numbers and fail gracefully if not as some changes are anticipated to this aspect of the JSON Lines file format. The --expand-flags argument can be provided in order to output flags as their symbolic representation instead of as an integer literal. In D3D12 conversions, bitfields are expressed as '0bxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' with as many x's as there are bits.</p>
<h4 id="void-pointers">Void Pointers</h4>
<p>Pointers to void and pointers to pointers to void are represented as strings with the hexadecimal integer value of the address in the capture file encoded within them. For example <code>"0x55f5aa64d2f0"</code>.</p>
<h4 id="structures">Structures</h4>
<p>Structures are represented as JSON objects. The names of their fields become element keys and their values are translated as described for any value in this section and the resulting JSON text is used as element values.</p>
<h4 id="pointers-to-structures">Pointers to Structures</h4>
<p>Where a pointer is to a single struct, as is the case for <code>pCreateInfo</code> and <code>pNext</code> struct pointers, the representation of the pointed-to type is nested within the JSON file at that point. If the pointer is null, the json type <code>null</code> will be used. The output does not preserve the identity of pointed-to structs. If the same struct with the same values was pointed-to a thousand times by an application during capture, the JSON representation will show its full, recursively expanded structure at each of those points of use. There is no mechanism to refer back to previously defined sub-trees of structs.</p>
<h4 id="arrays">Arrays</h4>
<p>Arrays, whether embedded directly in a struct, or pointed-to, are represented as a JSON array type. Each element of an array is represented by converting its type according to the appropriate rules. When a variable length array is represented in the C-API by adjacent <code>{count, pointer}</code> arguments or members, the JSON representation retains the explicit <code>count</code> even though that is duplicated in the length of the JSON array which inherits the name of the pointer in the pair. If an application assigns a null pointer to a pointer-to-array argument or struct member, it will be represented in the JSON as the <code>null</code> type. If a non-zero address is assigned to a pointer but a zero count is used, the representation will be an empty array: <code>[]</code>.</p>
<h3 id="top-level-structure">Top Level Structure</h3>
<p>All current and future lines have a top-level JSON object with a key that identifies the type of the line and a value that is a nested object holding the data for the line, possibly in further nested structure. The currently-defined keys are <code>"header"</code>, <code>"function"</code>, <code>"annotation"</code>, <code>"state"</code>, <code>"frame"</code>, and <code>"meta"</code>. A line can hold <em>exactly one of</em> a nested <code>"header"</code>, <code>"function"</code>, <code>"annotation"</code>, <code>"state"</code>, <code>"frame"</code>, or <code>"meta"</code>. D3D12 captures may also contain the key <code>"method"</code> for object methods.</p>
<p>A tool can work out what kind of JSON document each line contains by checking for the presence of the keys in the top-level object. In pseudocode that could look something like this:</p>
<pre><code>for line in input_lines:
  doc = json.parse(line)
  if doc.contains(&quot;function&quot;):
      process Vulkan API Call block
  else if doc.contains(&quot;method&quot;):
      process method call block
  else if doc.contains(&quot;header&quot;):
      process header block
  else if doc.contains(&quot;annotation&quot;):
      process annotation block
  else if doc.contains(&quot;state&quot;):
      process state block
  else if doc.contains(&quot;frame&quot;):
      process frame block
  else if doc.contains(&quot;meta&quot;):
      process meta command block
  else:
      warning: unknown JSON line
</code></pre>
<h3 id="header-objects">Header Objects</h3>
<p>All values of a header are strings.</p>
<ul>
<li><code>"source-path"</code>: The path to the gfxr file which was the source for conversion. The exact string passed to the application is stored, whether it is a relative or absolute path.</li>
<li><code>"gfxrecon-version"</code>: The release or build of GFXReconstruct used to do the conversion of the file.</li>
<li><code>"vulkan-version"</code>: The version of the Vulkan headers that the GFXReconstruct used for conversion was built against.</li>
</ul>
<p>Of note is that <code>"vulkan-version"</code> is currently erroneously reported even for D3D12 captures.</p>
<h3 id="meta-objects">Meta Objects</h3>
<p>Meta command objects contain <code>"index"</code> at the top level, which is a JSON number representing the position of the call in the sequence of successfully-decoded blocks in the original binary capture file, and a nested object under the key <code>"meta"</code> which contains the data captured from a meta command.</p>
<p>Examples of meta commands include host memory allocation, filling buffers and images, and resizing the application window.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb8-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">41</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="dt">&quot;meta&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ResizeWindowCommand2&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb8-6" title="6">      <span class="dt">&quot;surface_id&quot;</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb8-7" title="7">      <span class="dt">&quot;width&quot;</span><span class="fu">:</span> <span class="dv">800</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb8-8" title="8">      <span class="dt">&quot;height&quot;</span><span class="fu">:</span> <span class="dv">600</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="dt">&quot;pre_transform&quot;</span><span class="fu">:</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb8-10" title="10">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="fu">}</span><span class="er">,</span></a></code></pre></div>
<p>Of note is that the value of "data" in FillMemoryCommand is not preserved in the JSON output, instead being replaced by "[Binary data]".</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb9-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">74</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">&quot;meta&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;FillMemoryCommand&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb9-6" title="6">      <span class="dt">&quot;memory_id&quot;</span><span class="fu">:</span> <span class="dv">38</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb9-7" title="7">      <span class="dt">&quot;offset&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb9-8" title="8">      <span class="dt">&quot;size&quot;</span><span class="fu">:</span> <span class="dv">262144</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb9-9" title="9">      <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="st">&quot;[Binary data]&quot;</span></a>
<a class="sourceLine" id="cb9-10" title="10">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb9-11" title="11">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="fu">}</span></a></code></pre></div>
<h3 id="functionmethod-objects">Function/Method Objects</h3>
<p>Function/method objects contain <code>"index"</code> at the top level, which is a JSON number representing the position of the call in the sequence of successfully-decoded blocks in the original binary capture file, and a nested object under the key <code>"function"</code> (<code>"method"</code> in D3D12) which contains the data captured from a given call.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb10-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="dt">&quot;function&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb10-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;vkCreateInstance&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="dt">&quot;return&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb10-6" title="6">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb10-7" title="7">      <span class="er">...</span> <span class="er">details</span> <span class="er">omitted</span> <span class="er">...</span></a>
<a class="sourceLine" id="cb10-8" title="8">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="fu">}</span></a></code></pre></div>
<p>When debugging during replay, the value of the <code>"index"</code> field can be matched to the value of the GFXReconstruct <code>FileProcessor::block_index_</code> member variable. This allows a developer to see the history of calls in JSON form up to the point of interest in their debugger.</p>
<p>Within the nested object are several elements.</p>
<ul>
<li><code>"name"</code>: A JSON string which identifies the function that was called with the name defined in the C-API.</li>
<li><code>"return"</code>: An optional element whose value represents what was returned from Vulkan at capture time translated to JSON according to the C-API type as detailed above in section <em>Type Mapping of Values</em>.</li>
<li><code>"thread"</code>: An integer which represents the calling thread this API call was issued from.</li>
<li><code>"args"</code>: A nested object with a set of key:value pairs, one for each argument passed to the function. The arguments are output in the same order as defined by the C-API although JSON tools may reorder them arbitrarily after further processing. The value of each element is translated from the corresponding argument in the capture file as detailed above in section <em>Type Mapping of Values</em>.</li>
<li><code>"object"</code>: A nested object with a <code>"type"</code> and a <code>"handle"</code> (D3D12 only)</li>
</ul>
<h4 id="function-arguments">Function Arguments</h4>
<p>Arguments are delivered in a nested JSON object with the key <code>"args"</code>. The key for each field of the object is the name it has in the Vulkan C-API. The value of a field could be any JSON type, constrained to be appropriate to the C argument's type as detailed above in section <em>Type Mapping of Values</em>.</p>
<p>In this example of <code>"vkUnmapMemory"</code>, the values are the integer mappings of handles as stored in the capture file.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb11-1" title="1">    <span class="er">&quot;args&quot;:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">      <span class="dt">&quot;device&quot;</span><span class="fu">:</span> <span class="dv">6</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb11-3" title="3">      <span class="dt">&quot;memory&quot;</span><span class="fu">:</span> <span class="dv">27</span></a>
<a class="sourceLine" id="cb11-4" title="4">    <span class="fu">}</span></a></code></pre></div>
<p>A more complex example is illustrated by <code>vkCmdSetScissor</code>. Here we see the pointer to a variable number of entries from the C-API, <code>pScissors</code>, represented as a nested JSON array. Each element in that array is a JSON object for the corresponding C struct.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb12-1" title="1"><span class="er">&quot;args&quot;:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">    <span class="dt">&quot;commandBuffer&quot;</span><span class="fu">:</span> <span class="dv">43</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb12-3" title="3">    <span class="dt">&quot;firstScissor&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="dt">&quot;scissorCount&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb12-5" title="5">    <span class="dt">&quot;pScissors&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb12-6" title="6">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb12-7" title="7">        <span class="dt">&quot;offset&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb12-8" title="8">          <span class="dt">&quot;x&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb12-9" title="9">          <span class="dt">&quot;y&quot;</span><span class="fu">:</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb12-10" title="10">        <span class="fu">},</span></a>
<a class="sourceLine" id="cb12-11" title="11">        <span class="dt">&quot;extent&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb12-12" title="12">          <span class="dt">&quot;width&quot;</span><span class="fu">:</span> <span class="dv">256</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb12-13" title="13">          <span class="dt">&quot;height&quot;</span><span class="fu">:</span> <span class="dv">192</span></a>
<a class="sourceLine" id="cb12-14" title="14">        <span class="fu">}</span></a>
<a class="sourceLine" id="cb12-15" title="15">      <span class="fu">}</span></a>
<a class="sourceLine" id="cb12-16" title="16">    <span class="ot">]</span></a>
<a class="sourceLine" id="cb12-17" title="17">  <span class="fu">}</span></a></code></pre></div>
<h4 id="d3d12-method-1">D3D12 method</h4>
<p>D3D12 method objects are nearly identical to their Vulkan counterparts. They use the <code>"method"</code> key instead of <code>"function"</code>, and have an <code>"object"</code> field detailing the corresponding object type and handle value. See the example below.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb13-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">19</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb13-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;CreateCommandQueue&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-5" title="5">    <span class="dt">&quot;thread&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-6" title="6">    <span class="dt">&quot;object&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb13-7" title="7">      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;ID3D12Device&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-8" title="8">      <span class="dt">&quot;handle&quot;</span><span class="fu">:</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb13-9" title="9">    <span class="fu">},</span></a>
<a class="sourceLine" id="cb13-10" title="10">    <span class="dt">&quot;return&quot;</span><span class="fu">:</span> <span class="st">&quot;S_OK&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-11" title="11">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb13-12" title="12">      <span class="dt">&quot;pDesc&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb13-13" title="13">        <span class="dt">&quot;Type&quot;</span><span class="fu">:</span> <span class="st">&quot;D3D12_COMMAND_LIST_TYPE_COMPUTE&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-14" title="14">        <span class="dt">&quot;Priority&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-15" title="15">        <span class="dt">&quot;Flags&quot;</span><span class="fu">:</span> <span class="st">&quot;0x00000001&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-16" title="16">        <span class="dt">&quot;NodeMask&quot;</span><span class="fu">:</span> <span class="st">&quot;0b00000000000000000000000000000000&quot;</span></a>
<a class="sourceLine" id="cb13-17" title="17">      <span class="fu">},</span></a>
<a class="sourceLine" id="cb13-18" title="18">      <span class="dt">&quot;riid&quot;</span><span class="fu">:</span> <span class="st">&quot;IID_ID3D12CommandQueue&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-19" title="19">      <span class="dt">&quot;ppCommandQueue&quot;</span><span class="fu">:</span> <span class="dv">14</span></a>
<a class="sourceLine" id="cb13-20" title="20">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb13-21" title="21">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="fu">}</span></a></code></pre></div>
<h3 id="json-lines-to-json">JSON Lines to JSON</h3>
<p>Because, in .jsonl mode, every line is a separate JSON object, the output as a whole is not valid JSON. It can, however, be trivially transformed into a valid JSON array by appending a comma to each line and topping and tailing with square brackets. One may use <code>jq</code> from the command line to perform this operation:</p>
<pre><code>jq --slurp . file.jsonl &gt; file.json
</code></pre>
<h3 id="caveats-and-gotchas">Caveats and Gotchas</h3>
<h4 id="64-bit-integers">64 Bit Integers</h4>
<p>64 bit integers in the capture are output as the JSON number type. Parsers which strictly adhere to the standard should have no problem with that, including some fast native parsers like <a href="https://github.com/Tencent/rapidjson" TARGET="_blank">RapidJSON</a>, but some may choose to represent all numbers as 64 bit double precision floating point. This representation will not be able to represent all possible 64 bit integers. Javascript JSON parsers have been known to do that, as can be confirmed with the following Javascript snippet which fails to print <code>2^60</code> correctly.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">const</span> json <span class="op">=</span> <span class="st">&#39;{&quot;result&quot;:true, &quot;count&quot;:1152921504606846976}&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">const</span> obj <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(json)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="va">obj</span>.<span class="at">count</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">// Expected output: 1152921504606846976</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">// Actual output:   1152921504606847000</span></a></code></pre></div>
<h4 id="omitted-values">Omitted Values</h4>
<p>Captures don't store output structs or values for calls that failed, so some structs will be <code>null</code> (Python <code>None</code>) even though the app passed in something.</p>
<h2 id="recipes">Recipes</h2>
<p>Once the JSON has been emitted, the the next step is to do something with it. Below are some example usages of the output, tested in Bash. These are presented using a file called <code>vkcube.f1.gfxr</code>, a capture of the first frame of <code>vkcube</code>, and <code>vkcube.f1-10.gfxr</code>, a capture of its first ten frames, which you can easily reproduce locally using the GFXReconstruct capture layer.</p>
<p>When composing pipelines for interactive use it is usually worthwhile to have each tool use unbuffered IO so results make it through to printing to the console as soon as possible. The switches for that are <code>--line-buffered</code> for <code>grep</code> and <code>--unbuffered</code> for <code>jq</code>.</p>
<h3 id="grep-for-functions">Grep for Functions</h3>
<p>We can limit output to functions of particular interest easily with a pipeline.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="ex">gfxrecon-convert</span> --output stdout --format jsonl vkcube.f1-10.gfxr <span class="kw">|</span> <span class="fu">fgrep</span> --line-buffered <span class="st">&quot;vkQueuePresent&quot;</span></a></code></pre></div>
<p>We use <code>--line-buffered</code> to keep results flowing. As soon as a new JSON Lines line is matched, it is passed to the next stage, in this case being displayed. In this example we see the <code>pImageIndices</code> index being cycled through:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb17-1" title="1"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">137</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">10</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">0</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">142</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">13</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">1</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">147</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">10</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">2</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">152</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">13</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">0</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">157</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">10</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">1</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">162</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueuePresentKHR&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">7</span><span class="fu">,</span><span class="dt">&quot;pPresentInfo&quot;</span><span class="fu">:{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">13</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;swapchainCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSwapchains&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">14</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pImageIndices&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">2</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pResults&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}}}}</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="er">...</span></a></code></pre></div>
<h3 id="pretty-print-json">Pretty Print JSON</h3>
<p>There are many tools that will pretty-print JSON Lines. A common one on many platforms, written in C, and with no dependencies is <code>jq</code>. Here we output to stdout and pipe through them to <code>jq</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" title="1"><span class="ex">gfxrecon-convert</span> --output stdout --format jsonl vkcube.f1.gfxr <span class="kw">|</span> <span class="ex">jq</span> .</a></code></pre></div>
<p>The result (abbreviated below) is nicely formatted for human comprehension and preserves the ordering of function arguments, to match the C-API.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">102</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-4" title="4">  <span class="dt">&quot;function&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb19-5" title="5">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;vkCmdBindPipeline&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-6" title="6">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb19-7" title="7">      <span class="dt">&quot;commandBuffer&quot;</span><span class="fu">:</span> <span class="dv">43</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-8" title="8">      <span class="dt">&quot;pipelineBindPoint&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_PIPELINE_BIND_POINT_GRAPHICS&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-9" title="9">      <span class="dt">&quot;pipeline&quot;</span><span class="fu">:</span> <span class="dv">42</span></a>
<a class="sourceLine" id="cb19-10" title="10">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb19-11" title="11">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="fu">}</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="fu">{</span></a>
<a class="sourceLine" id="cb19-14" title="14">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">107</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-15" title="15">  <span class="dt">&quot;function&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb19-16" title="16">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;vkCmdEndRenderPass&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb19-17" title="17">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb19-18" title="18">      <span class="dt">&quot;commandBuffer&quot;</span><span class="fu">:</span> <span class="dv">43</span></a>
<a class="sourceLine" id="cb19-19" title="19">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb19-20" title="20">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="fu">}</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="er">...</span></a></code></pre></div>
<h3 id="pretty-print-yaml">Pretty Print YAML</h3>
<p>The <a href="https://github.com/mikefarah/yq" TARGET="_blank">yq</a> YAML processor can give a cleaner pretty print. We pipe our output into it after adding a line with the YAML separator <code>---</code> between each JSON line.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" title="1">  <span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">sed</span> -s <span class="st">&quot;s/$/\n---\n/&quot;</span> <span class="kw">|</span> <span class="ex">yq</span> -P</a></code></pre></div>
<p>The same excerpt as shown for the JSON pretty print above:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb21-1" title="1"><span class="fu">index:</span><span class="at"> </span><span class="dv">102</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="fu">function:</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="fu">name:</span><span class="at"> vkCmdBindPipeline</span></a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="fu">args:</span></a>
<a class="sourceLine" id="cb21-5" title="5">    <span class="fu">commandBuffer:</span><span class="at"> </span><span class="dv">43</span></a>
<a class="sourceLine" id="cb21-6" title="6">    <span class="fu">pipelineBindPoint:</span><span class="at"> VK_PIPELINE_BIND_POINT_GRAPHICS</span></a>
<a class="sourceLine" id="cb21-7" title="7">    <span class="fu">pipeline:</span><span class="at"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="ot">---</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="fu">index:</span><span class="at"> </span><span class="dv">107</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="fu">function:</span></a>
<a class="sourceLine" id="cb21-11" title="11">  <span class="fu">name:</span><span class="at"> vkCmdEndRenderPass</span></a>
<a class="sourceLine" id="cb21-12" title="12">  <span class="fu">args:</span></a>
<a class="sourceLine" id="cb21-13" title="13">    <span class="fu">commandBuffer:</span><span class="at"> </span><span class="dv">43</span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="ot">---</span></a></code></pre></div>
<h3 id="list-of-functions-used-in-a-capture">List of Functions Used in a Capture</h3>
<p>One useful thing to do with a capture is to generate a summary of the Vulkan functions used within it. Given a large set of diverse captures, generating this summary once for each capture ahead of time allows later recursive greps to find all the files that use a particular function rapidly. This would be useful when collecting a set of existing traces to reproduce a bug somewhere in the graphics stack for which that function was implicated.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;&quot;function&quot;|&quot;method&quot;&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/.*</span><span class="dt">\&quot;</span><span class="st">name</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">vk\([^</span><span class="dt">\&quot;</span><span class="st">]*\).*/vk\1/&quot;</span> <span class="kw">|</span> <span class="fu">sort</span> -u</a></code></pre></div>
<p>Output:</p>
<pre><code>vkAcquireNextImageKHR
vkAllocateCommandBuffers
vkAllocateDescriptorSets
vkAllocateMemory
vkBeginCommandBuffer
vkBindBufferMemory
vkBindImageMemory
...
vkUnmapMemory
vkUpdateDescriptorSets
vkWaitForFences
</code></pre>
<p>Splitting the <code>sed</code> command in two should execute several times faster:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;&quot;function&quot;|&quot;method&quot;&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/.*</span><span class="dt">\&quot;</span><span class="st">name</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">vk/vk/&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">,.*//&quot;</span> <span class="kw">|</span> <span class="fu">sort</span> -u</a></code></pre></div>
<p>For large captures, screening out runs of duplicate function names before the sort can be a little faster still:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb25-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;&quot;function&quot;|&quot;method&quot;&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/.*</span><span class="dt">\&quot;</span><span class="st">name</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">vk/vk/&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">,.*//&quot;</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">sort</span> -u</a></code></pre></div>
<h3 id="transform-arguments-to-positional-array-form">Transform Arguments to Positional Array Form</h3>
<p>While the JSON format for functions represents arguments as a JSON object, it is straightforward to transform that to an array that bakes in the argument ordering. This substitution in <code>jq</code> turns each argument into its own JSON object with name and value fields, and orders them all in an array.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb26-1" title="1"><span class="ex">gfxrecon-convert</span> --output stdout --format jsonl vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;&quot;function&quot;|&quot;method&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.function.args = (.function.args | to_entries | map_values({&quot;name&quot;:(.key), &quot;value&quot;:(.value)}))&#39;</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb27-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="dv">76</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="dt">&quot;function&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-4" title="4">    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;vkMapMemory&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-5" title="5">    <span class="dt">&quot;return&quot;</span><span class="fu">:</span> <span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-6" title="6">    <span class="dt">&quot;args&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb27-7" title="7">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-8" title="8">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;device&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-9" title="9">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">6</span></a>
<a class="sourceLine" id="cb27-10" title="10">      <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-11" title="11">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-12" title="12">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;memory&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-13" title="13">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">35</span></a>
<a class="sourceLine" id="cb27-14" title="14">      <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-15" title="15">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-16" title="16">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;offset&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-17" title="17">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb27-18" title="18">      <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-19" title="19">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-20" title="20">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;size&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-21" title="21">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">18446744073709552000</span></a>
<a class="sourceLine" id="cb27-22" title="22">      <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-23" title="23">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-24" title="24">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;flags&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-25" title="25">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb27-26" title="26">      <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-27" title="27">      <span class="fu">{</span></a>
<a class="sourceLine" id="cb27-28" title="28">        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ppData&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-29" title="29">        <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;0x55f5aa64d380&quot;</span></a>
<a class="sourceLine" id="cb27-30" title="30">      <span class="fu">}</span></a>
<a class="sourceLine" id="cb27-31" title="31">    <span class="ot">]</span></a>
<a class="sourceLine" id="cb27-32" title="32">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb27-33" title="33"><span class="fu">}</span></a></code></pre></div>
<p>This can be stripped-down to just the values:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;&quot;function&quot;|&quot;method&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -c <span class="st">&#39;.function.args = (.function.args | to_entries | map_values(.value))&#39;</span></a></code></pre></div>
<p>Note the <code>-c</code> option to <code>jq</code> preserves the JSON Lines output rather than pretty-printing indented JSON.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb29-1" title="1"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">72</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkBindBufferMemory&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="dv">32</span><span class="ot">,</span><span class="dv">33</span><span class="ot">,</span><span class="dv">0</span><span class="ot">]</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">73</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkCreateBuffer&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;flags&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;size&quot;</span><span class="fu">:</span><span class="dv">1216</span><span class="fu">,</span><span class="dt">&quot;usage&quot;</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span><span class="dt">&quot;sharingMode&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SHARING_MODE_EXCLUSIVE&quot;</span><span class="fu">,</span><span class="dt">&quot;queueFamilyIndexCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pQueueFamilyIndices&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">,</span><span class="kw">null</span><span class="ot">,</span><span class="dv">34</span><span class="ot">]</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">74</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkGetBufferMemoryRequirements&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="dv">34</span><span class="ot">,</span><span class="fu">{</span><span class="dt">&quot;size&quot;</span><span class="fu">:</span><span class="dv">1280</span><span class="fu">,</span><span class="dt">&quot;alignment&quot;</span><span class="fu">:</span><span class="dv">256</span><span class="fu">,</span><span class="dt">&quot;memoryTypeBits&quot;</span><span class="fu">:</span><span class="dv">1921</span><span class="fu">}</span><span class="ot">]</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">75</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkAllocateMemory&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;allocationSize&quot;</span><span class="fu">:</span><span class="dv">1280</span><span class="fu">,</span><span class="dt">&quot;memoryTypeIndex&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">}</span><span class="ot">,</span><span class="kw">null</span><span class="ot">,</span><span class="dv">35</span><span class="ot">]</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">76</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkMapMemory&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="dv">35</span><span class="ot">,</span><span class="dv">0</span><span class="ot">,</span><span class="dv">18446744073709552000</span><span class="ot">,</span><span class="dv">0</span><span class="ot">,</span><span class="st">&quot;0x55f5aa64d380&quot;</span><span class="ot">]</span><span class="fu">}}</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">77</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkBindBufferMemory&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">6</span><span class="ot">,</span><span class="dv">34</span><span class="ot">,</span><span class="dv">35</span><span class="ot">,</span><span class="dv">0</span><span class="ot">]</span><span class="fu">}}</span></a></code></pre></div>
<h3 id="all-unique-argument-names">All Unique Argument Names</h3>
<p>This pipeline summarizes the names of function arguments and struct member names recursively included from arguments into a json array on each line. These might be useful to keep beside a set of multi-gigabyte binary traces to allow fast grepping when looking for traces that use particular named arguments.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout vkcube.f1.gfxr <span class="kw">|</span> <span class="ex">jq</span>  -c <span class="st">&quot;[.. | objects | keys[]] | unique&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">args</span><span class="dt">\&quot;</span><span class="st">,//&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">index</span><span class="dt">\&quot;</span><span class="st">,//&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">name</span><span class="dt">\&quot;</span><span class="st">,//&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/</span><span class="dt">\&quot;</span><span class="st">return</span><span class="dt">\&quot;</span><span class="st">,//&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/,</span><span class="dt">\&quot;</span><span class="st">function</span><span class="dt">\&quot;</span><span class="st">//&quot;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span></a></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb31-1" title="1"><span class="er">...</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="ot">[</span><span class="st">&quot;alignment&quot;</span><span class="ot">,</span><span class="st">&quot;buffer&quot;</span><span class="ot">,</span><span class="st">&quot;device&quot;</span><span class="ot">,</span><span class="st">&quot;memoryTypeBits&quot;</span><span class="ot">,</span><span class="st">&quot;pMemoryRequirements&quot;</span><span class="ot">,</span><span class="st">&quot;size&quot;</span><span class="ot">]</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="ot">[</span><span class="st">&quot;alignment&quot;</span><span class="ot">,</span><span class="st">&quot;device&quot;</span><span class="ot">,</span><span class="st">&quot;image&quot;</span><span class="ot">,</span><span class="st">&quot;memoryTypeBits&quot;</span><span class="ot">,</span><span class="st">&quot;pMemoryRequirements&quot;</span><span class="ot">,</span><span class="st">&quot;size&quot;</span><span class="ot">]</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="ot">[</span><span class="st">&quot;allocationSize&quot;</span><span class="ot">,</span><span class="st">&quot;device&quot;</span><span class="ot">,</span><span class="st">&quot;memoryTypeIndex&quot;</span><span class="ot">,</span><span class="st">&quot;pAllocateInfo&quot;</span><span class="ot">,</span><span class="st">&quot;pAllocator&quot;</span><span class="ot">,</span><span class="st">&quot;pMemory&quot;</span><span class="ot">,</span><span class="st">&quot;pNext&quot;</span><span class="ot">,</span><span class="st">&quot;sType&quot;</span><span class="ot">]</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="er">...</span></a></code></pre></div>
<h3 id="truncate-at-match">Truncate at Match</h3>
<p>When looking at a multi-gigabyte capture file, it can be useful to limit the output of conversion, ending it early, for example to concentrate on the first frame. A little Python script can enable that.</p>
<p><code>stop-after-match.py</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb32-1" title="1"><span class="co">#! /usr/bin/python3</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="im">import</span> argparse</a>
<a class="sourceLine" id="cb32-4" title="4">parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Pass through input until match&#39;</span>)</a>
<a class="sourceLine" id="cb32-5" title="5">parser.add_argument(<span class="st">&#39;match&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;The string to stop after seeing on a line&#39;</span>)</a>
<a class="sourceLine" id="cb32-6" title="6">args <span class="op">=</span> parser.parse_args()</a>
<a class="sourceLine" id="cb32-7" title="7">match <span class="op">=</span> args.match</a>
<a class="sourceLine" id="cb32-8" title="8"></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="cf">for</span> l <span class="kw">in</span> sys.stdin:</a>
<a class="sourceLine" id="cb32-10" title="10">    <span class="co"># Print out long lines:</span></a>
<a class="sourceLine" id="cb32-11" title="11">    <span class="bu">print</span>(l,  end <span class="op">=</span> <span class="st">&#39;&#39;</span>, flush<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb32-12" title="12">    <span class="cf">if</span> match <span class="kw">in</span> l:</a>
<a class="sourceLine" id="cb32-13" title="13">        exit(<span class="dv">0</span>)</a></code></pre></div>
<p>As an example, let's use that to see all the submits in the first frame:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="ex">gfxrecon-convert</span> --format jsonl --output stdout bigcapture.gfxr <span class="kw">|</span> <span class="ex">stop-after-match.py</span> vkQueuePresent <span class="kw">|</span> <span class="fu">fgrep</span> --line-buffered vkQueueSubmit</a></code></pre></div>
<p>For one particular 33GB capture, the above pipeline runs in around a second on a laptop because conversion ends at the match. In the output we see 301 single command buffer single submits to get to the first frame which would give the developer inspiration to look into merging some of them if possible.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb34-1" title="1"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">168</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">68</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">91</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">89</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">337</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">96</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">98</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">99</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="er">...</span> <span class="er">skip</span> <span class="er">hundreds</span> <span class="er">of</span> <span class="er">similar</span> <span class="er">calls</span> <span class="er">...</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6580</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">96</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">128</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">129</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6585</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">96</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">131</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">132</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6755</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">68</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">1894</span><span class="ot">,</span><span class="dv">1895</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">1896</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6757</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">68</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">1912</span><span class="ot">,</span><span class="dv">1913</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">1897</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6812</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">68</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">2120</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="st">&quot;VK_NULL_HANDLE&quot;</span><span class="fu">}}}</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span><span class="dv">6814</span><span class="fu">,</span><span class="dt">&quot;function&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;vkQueueSubmit&quot;</span><span class="fu">,</span><span class="dt">&quot;return&quot;</span><span class="fu">:</span><span class="st">&quot;VK_SUCCESS&quot;</span><span class="fu">,</span><span class="dt">&quot;args&quot;</span><span class="fu">:{</span><span class="dt">&quot;queue&quot;</span><span class="fu">:</span><span class="dv">68</span><span class="fu">,</span><span class="dt">&quot;submitCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSubmits&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;sType&quot;</span><span class="fu">:</span><span class="st">&quot;VK_STRUCTURE_TYPE_SUBMIT_INFO&quot;</span><span class="fu">,</span><span class="dt">&quot;pNext&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;waitSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pWaitSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">867</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;pWaitDstStageMask&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">65536</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;commandBufferCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pCommandBuffers&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">2167</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;signalSemaphoreCount&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">&quot;pSignalSemaphores&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="dv">878</span><span class="ot">]</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;fence&quot;</span><span class="fu">:</span><span class="dv">877</span><span class="fu">}}}</span></a></code></pre></div>
<p>Similar line-oriented scripts could extend this idea to outputting the first n frames or an arbitrary single frame without needing to parse the JSON.</p>
<h2 id="faq">FAQ</h2>
<ul>
<li>Where is the type information?
<ul>
<li>Type information is defined by the xml of the Vulkan specification. Applications using the format are required to derive type information from there when introspecting on the output or from their programmers' reading of the specification. Annotating every value with its type as done by some other tools such as the API Dump layer was a tradeoff not taken based on anticipated uses for this format.</li>
</ul></li>
<li>Can I rely on the ordering of <code>args</code> object <code>key:value</code> pairs?
<ul>
<li>Convert will output fields in the same order as they appear in the parameter lists of the corresponding C API. While that order is not guaranteed to be preserved by all JSON parsers, many do preserve it by default or can be configured to do so. The JSON module in Python can <a href="https://stackoverflow.com/a/6921760" TARGET="_blank">use an <code>OrderedDict</code></a> for example. To bake the order in, args may be transformed into an array with <code>jq</code> as shown in the section <a href="#transform-arguments-to-positional-array-form">Transform Arguments to Positional Array Form</a>.</li>
</ul></li>
</ul>
</article>
</body>
</html>

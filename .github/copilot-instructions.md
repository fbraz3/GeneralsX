# AI Coding Agent Quickstart

- **Scope**: Two games; Zero Hour lives in `GeneralsMD/` (primary), Generals in `Generals/`; shared engine/libs under `Core/`.
- **Platform strategy**: Cross-platform port targeting Linux, macOS, and Windows under a single codebase: SDL3 (windowing/input) + DXVK (DX8 to Vulkan graphics) + OpenAL (audio) + 64-bit. Legacy VC6 + win32 builds remain as upstream baseline. Isolate platform code to `Core/GameEngineDevice/` and `Core/Libraries/Source/Platform/`.
- **Key entry points**: Game launchers in `GeneralsMD/Code/Main/WinMain.cpp` and `Generals/Code/Main/WinMain.cpp`. Renderer device setup in `Core/GameEngineDevice/Source/` (DX8 now; DXVK path follows fighter19 reference under `references/fighter19-dxvk-port/GeneralsMD/Code/GameEngineDevice/`).
- **Critical convention**: Every user-facing code change needs `// GeneralsX @keyword author DD/MM/YYYY Description` above it. Keywords: @bugfix/@feature/@performance/@refactor/@tweak/@build.
- **Build presets**: Legacy: `cmake --preset vc6` or `win32`. Cross-platform: `linux64-deploy` (primary), `macos-deploy` (TBD), `windows64-deploy` (TBD). Linux via Docker: `./scripts/docker-configure-linux.sh linux64-deploy` then `./scripts/docker-build-linux-zh.sh linux64-deploy`. MinGW cross: `./scripts/docker-build-mingw-zh.sh mingw-w64-i686`.
- **Testing hotspots**: Replay compatibility uses VC6 optimized builds with `RTS_BUILD_OPTION_DEBUG=OFF` and replays in `GeneralsReplays/`; run via `generalszh.exe -jobs 4 -headless -replay subfolder/*.rep`. Keep determinism—avoid logic changes when touching rendering/audio paths.
- **Platform isolation rules**: No platform-specific code inside gameplay (GameLogic). Use compile guards and device/platform layers. Keep DX8/Miles path working for VC6; add DXVK/OpenAL behind feature flags. SDL3 is the unified platform layer — no native POSIX, Win32, or Cocoa calls in game code.
- **Reference guides**: DXVK patterns in `references/fighter19-dxvk-port/` (CMake presets, SDL3 hooks, device wrappers). OpenAL/Miles mapping ideas in `references/jmarshall-win64-modern/Code/Audio/` (Generals-only, adapt carefully for Zero Hour).
- **Docs workflow**: Monthly diary in `docs/DEV_BLOG/YYYY-MM-DIARY.md` (newest-first). Active work notes in `docs/WORKDIR/` (phases/planning/reports/support/audit/lessons). Do not drop working docs directly under `docs/` root.
- **Common pitfalls**: Manual memory (delete/delete[]; STLPort for VC6). Retail compatibility matters—debug options break replays. Watch include-case on Linux; scripts/cpp/fixIncludesCase.sh can help. Avoid big refactors mixed with gameplay fixes.
- **Where to tweak build flags**: `CMakePresets.json` for presets; `cmake/config-build.cmake` and `cmake/dx8.cmake` for renderer flags; `cmake/miles.cmake` for audio; `cmake/mingw.cmake` for cross builds.
- **Run recipes**: Linux binary smoke: `./scripts/docker-smoke-test-zh.sh linux64-deploy`. Quick Windows run (win32 preset): see tasks using `scripts/run_zh.ps1`/`scripts/run_zh.ps1 -Generals`.
- **When backporting to Generals**: Only for shared platform/back-end changes; avoid expansion-specific logic moves. Keep Zero Hour first.

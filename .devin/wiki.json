{
  "repo_notes": [
    {
      "content": "GeneralsX is a community-driven Linux port of Command & Conquer: Generals Zero Hour (2003). The primary target is GeneralsXZH (Zero Hour expansion in GeneralsMD/), with GeneralsX (base game in Generals/) as secondary. Both share a large C++ engine (~500k+ LOC) originally built for Windows with VC6/DirectX8/Miles Sound System. The Linux port strategy uses DXVK for DirectX8→Vulkan translation and SDL3 for windowing/input, while preserving retail compatibility and Windows builds.",
      "author": "GeneralsX Team"
    },
    {
      "content": "Three reference repositories guide the port: (1) TheSuperHackers (upstream Windows baseline, stable VC6 builds), (2) fighter19's DXVK port (references/fighter19-dxvk-port/ — primary graphics/Linux reference, fully functional), (3) jmarshall's modern port (references/jmarshall-win64-modern/ — primary audio/OpenAL reference, Generals-only). Platform-specific code must be isolated to Core/GameEngineDevice/ and Core/Libraries/Source/Platform/. Never put Linux-specific code inside gameplay logic (GameLogic/).",
      "author": "GeneralsX Team"
    },
    {
      "content": "Build system uses CMake with multiple presets: 'vc6' (Windows, Visual Studio 6, stable baseline), 'win32' (Windows, MSVC 2022, experimental), 'linux64-deploy' (Linux native ELF via Docker), 'linux64-testing' (Linux debug), 'mingw-w64-i686' (MinGW cross-compile Windows .exe from Linux/macOS). Development is done on macOS; Linux/Windows builds use Docker containers. Key scripts in scripts/. Build logs go to logs/. DXVK headers are fetched via CMake FetchContent into build/_deps/dxvk-src/ and require pre-guard patches for type conflicts (MEMORYSTATUS, IUnknown).",
      "author": "GeneralsX Team"
    },
    {
      "content": "Development phases: Phase 0 (analysis/planning, current), Phase 1 (DXVK graphics integration), Phase 2 (OpenAL audio replacing Miles Sound System), Phase 3 (Bink video replacement spike), Phase 4 (polish/hardening). Documentation structure: docs/DEV_BLOG/ (monthly diaries, newest-first), docs/WORKDIR/phases/ (phase plans), docs/WORKDIR/lessons/ (lessons learned), docs/WORKDIR/reports/ (session reports), docs/WORKDIR/support/ (technical discoveries). Every user-facing code change needs a GeneralsX annotation comment: // GeneralsX @keyword author DD/MM/YYYY Description.",
      "author": "GeneralsX Team"
    },
    {
      "content": "Core shared engine lives under Core/: GameEngine/ (logic, audio, rendering abstractions), GameEngineDevice/ (platform-specific device implementations — DX8 now, DXVK target), Libraries/ (utilities: WWVegas, math, containers, STLPort). The cmake/ directory contains modular cmake scripts: dx8.cmake (renderer), miles.cmake (audio), openal.cmake (OpenAL target), dxvk-macos-patches.py (DXVK patching), toolchains/ and triplets/ for cross-compilation.",
      "author": "GeneralsX Team"
    }
  ],
  "pages": [
    {
      "title": "Project Overview",
      "purpose": "High-level overview of GeneralsX: goals, scope, strategy, platform targets, and relationship between the three reference repositories (TheSuperHackers, fighter19, jmarshall). Explain the port phases and non-negotiable constraints (Windows VC6 compatibility, retail compatibility).",
      "parent": null
    },
    {
      "title": "Repository Structure",
      "purpose": "Document the top-level directory layout: GeneralsMD/ (Zero Hour, primary), Generals/ (base game, secondary), Core/ (shared engine), Dependencies/, references/, cmake/, scripts/, docs/, build/. Explain what belongs in each folder and the platform isolation rules.",
      "parent": "Project Overview"
    },
    {
      "title": "Build System & Presets",
      "purpose": "Document CMakePresets.json and all build presets (vc6, win32, linux64-deploy, linux64-testing, mingw-w64-i686, macos-vulkan). Explain the cmake/ modular scripts (dx8.cmake, miles.cmake, openal.cmake, mingw.cmake, sdl3.cmake, dxvk-macos-patches.py). Cover Docker-based build workflow for Linux and MinGW targets from macOS.",
      "parent": "Project Overview"
    },
    {
      "title": "Scripts Reference",
      "purpose": "Document all scripts in scripts/: Docker build scripts (docker-build-linux-zh.sh, docker-build-mingw-zh.sh, docker-build-images.sh), configure scripts (docker-configure-linux.sh), deploy/run scripts (deploy-linux-zh.sh, run-linux-zh.sh, run-macos-zh.sh), build-macos-zh.sh, and fix/patch utilities (fix_*.py, apply-patch-13-manual.sh).",
      "parent": "Build System & Presets"
    },
    {
      "title": "Core Engine Architecture",
      "purpose": "Document Core/ shared libraries: GameEngine/ (game logic, audio abstraction, rendering abstraction), GameEngineDevice/ (platform rendering device — DX8 implementation and DXVK target), Libraries/ (WWVegas, math, containers, STLPort for VC6 compatibility). Map the major subsystems and their interdependencies.",
      "parent": null
    },
    {
      "title": "Rendering Device Layer",
      "purpose": "Document Core/GameEngineDevice/: current DirectX8 implementation, entry points, device initialization, and how the W3D renderer is structured. This is the primary integration point for DXVK. Reference fighter19's changes in references/fighter19-dxvk-port/GeneralsMD/Code/GameEngineDevice/ as the porting target.",
      "parent": "Core Engine Architecture"
    },
    {
      "title": "Audio System",
      "purpose": "Document the current Miles Sound System integration: where it initializes, how it interfaces with the game engine (Core/GameEngine/Audio/). Document jmarshall's OpenAL implementation in references/jmarshall-win64-modern/Code/Audio/ as the Phase 2 replacement target. Highlight Zero Hour-specific audio hooks that differ from base Generals.",
      "parent": "Core Engine Architecture"
    },
    {
      "title": "Platform Abstraction Layer",
      "purpose": "Document Core/Libraries/Source/Platform/: the POSIX compatibility utilities, filesystem abstractions, threading primitives, and Windows API wrappers used or needed for the Linux port. Explain the platform isolation rules and compiler guards (#ifdef BUILD_WITH_DXVK, #ifndef _WIN32).",
      "parent": "Core Engine Architecture"
    },
    {
      "title": "Linux Port Strategy",
      "purpose": "Document the end-to-end Linux port approach: DXVK for DirectX8→Vulkan, SDL3 for windowing/input, OpenAL for audio (Phase 2), MinGW or native GCC toolchain. Cover the pre-guard patch strategy for DXVK type conflicts (MEMORYSTATUS, IUnknown redefinitions) in build/_deps/dxvk-src/. Reference fighter19's port as the working baseline.",
      "parent": null
    },
    {
      "title": "DXVK Integration",
      "purpose": "Document the DXVK DirectX8→Vulkan integration: how DXVK headers are fetched via FetchContent, the ephemeral patch problem and pre-guard solution in GeneralsMD/Code/CompatLib/Include/windows_compat.h, SDL3 windowing hooks, and the device wrapper pattern from fighter19's reference. Cover cmake/dx8.cmake and related CMake flags.",
      "parent": "Linux Port Strategy"
    },
    {
      "title": "OpenAL Audio Integration (Phase 2)",
      "purpose": "Document the planned Miles Sound System → OpenAL replacement: API compatibility layer design, audio format conversion, Zero Hour-specific adaptation notes from jmarshall's Generals-only implementation, and the USE_OPENAL vs USE_MILES compile flag strategy.",
      "parent": "Linux Port Strategy"
    },
    {
      "title": "Reference Repositories",
      "purpose": "Document the three reference repositories under references/: fighter19-dxvk-port/ (DXVK/Linux, full ZH coverage, primary graphics reference), jmarshall-win64-modern/ (OpenAL/Win64, Generals-only, primary audio reference), thesuperhackers-main/ (upstream Windows baseline). Explain what to use each reference for and adaptation notes.",
      "parent": "Linux Port Strategy"
    },
    {
      "title": "Zero Hour (GeneralsMD)",
      "purpose": "Document GeneralsMD/ structure: Code/ subdirectories (GameEngine/, GameEngineDevice/, Main/WinMain.cpp entry point), Run/ game data layout, CMakeLists.txt targets. Highlight Zero Hour-specific features that differ from base Generals and require special attention during the port.",
      "parent": null
    },
    {
      "title": "Generals Base Game",
      "purpose": "Document Generals/ structure: Code/ subdirectories, Run/ layout, CMakeLists.txt targets, and its relationship to Zero Hour. Explain the backporting policy: only platform/backend changes are backported from ZH to Generals, never expansion-specific logic.",
      "parent": null
    },
    {
      "title": "Windows Build Compatibility",
      "purpose": "Document the Windows VC6 and Win32 (MSVC 2022) build requirements: STLPort usage for VC6 (stlport.diff), manual memory management conventions (delete/delete[]), replay compatibility requirements (determinism, RTS_BUILD_OPTION_DEBUG=OFF), and the merge workflow with TheSuperHackers upstream.",
      "parent": null
    },
    {
      "title": "Development Workflow",
      "purpose": "Document the day-to-day development process: upstream merge from TheSuperHackers, code annotation convention (// GeneralsX @keyword author DD/MM/YYYY Description), documentation update requirement before commits (DEV_BLOG diary), lessons-learned workflow in docs/WORKDIR/lessons/, and VS Code tasks.",
      "parent": null
    },
    {
      "title": "Documentation Structure",
      "purpose": "Document docs/ layout: DEV_BLOG/ (monthly diaries, newest-first format), WORKDIR/phases/ (phase implementation plans), WORKDIR/planning/ (strategic documents), WORKDIR/reports/ (session reports), WORKDIR/support/ (technical discoveries), WORKDIR/audit/, WORKDIR/lessons/ (lessons learned for future sessions), ETC/ (reference/historical), KNOWN_ISSUES/.",
      "parent": "Development Workflow"
    }
  ]
}
